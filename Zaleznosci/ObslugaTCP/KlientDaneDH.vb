Imports System.Numerics

Friend Class KlientDaneDH
    Inherits DHInicjalizuj

    Private Const LICZBA_G As Integer = 5
    Private ReadOnly LICZBY_PIERWSZE As Long() = {1005001007009, 1005001007033, 1005001007039, 1005001007047, 1005001007051, 1005001007053, 1005001007063, 1005001007069, 1005001007107, 1005001007141, 1005001007177, 1005001007189, 1005001007203, 1005001007251, 1005001007267, 1005001007279, 1005001007303, 1005001007317, 1005001007347, 1005001007369, 1005001007371, 1005001007401, 1005001007419, 1005001007441, 1005001007453, 1005001007489, 1005001007503, 1005001007537, 1005001007561, 1005001007573, 1005001007623, 1005001007629, 1005001007653, 1005001007657, 1005001007671, 1005001007677, 1005001007693, 1005001007713, 1005001007761, 1005001007809, 1005001007873, 1005001007893, 1005001007953, 1005001007971, 1005001007999, 1005001008019, 1005001008029, 1005001008049, 1005001008071, 1005001008091, 1005001008139, 1005001008173, 1005001008197, 1005001008217, 1005001008247, 1005001008257, 1005001008269, 1005001008301, 1005001008311, 1005001008337, 1005001008353, 1005001008419, 1005001008433, 1005001008467, 1005001008553, 1005001008619, 1005001008629, 1005001008653, 1005001008673, 1005001008703, 1005001008707, 1005001008709, 1005001008731, 1005001008751, 1005001008761, 1005001008793, 1005001008797, 1005001008929, 1005001008931, 1005001008959}

    Friend Property LiczbaPrywA As BigInteger

    Friend Sub New()
        Dim rnd As New Random

        LiczbaPrywA = PobierzLosowaDuzaLiczbe()

        LiczbaG = LICZBA_G
        LiczbaP = New BigInteger(LICZBY_PIERWSZE(rnd.Next(0, LICZBY_PIERWSZE.Length)))
        LiczbaA = BigInteger.ModPow(LiczbaG, LiczbaPrywA, LiczbaP)
    End Sub

End Class